<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        div{
            width: 30%;
            margin-left: 10%;
        }
        input{
            margin-bottom: 5px;
        }
        #container{
            width: 1000px;
        }
        .div{
            width: 100%;
            height: 50px;
            margin: 10px;
            display: flex;
        }
        img{
            width: 50px;
        }
    </style>
</head>
<body>

    <div>
        <h1>Check search</h1>
        <input oninput="deBounce(showData, 1000)" type="text" id="searchBox">
    </div>

    <h1>Check Products Append</h1>
    <div id="container"></div>
  
</body>
</html>

<script>

    let prodContainer = document.getElementById("container");
    //To GET data from server
    fetch("http://localhost:3000/api/products")
    .then((res) => {
        return res.json();
    })
    .then((res) => {
        console.log("res: ", res);
        appendProduct(res);
    })
    .catch((err) => {
        console.log(err);
    })

    function appendProduct(products){
        products.forEach(function(product){
            let div = document.createElement("div");
            div.setAttribute("class", "div");

            let productImg = document.createElement("img");
            productImg.src = product.product_image;

            let productName = document.createElement("div");
            productName.innerHTML = product.product_name;

            div.append(productImg, productName);
            prodContainer.append(div);
        });
    }

    //Debounce
    let timerId;

    function showData(){

        let inputValue = document.getElementById("searchBox").value;

        fetch("http://localhost:3000/api/products")
        .then((res) => {
            return res.json();
        })
        .then((res) => {
            console.log("For Search: ", res);
            res.forEach(function(data){
                let temp = "";
                for(let i = 0; i < data.product_name.length; i++){
                    temp += data.product_name[i];
                    if(inputValue == temp){
                        console.log(data.product_name);
                    }
                    // console.log(inputValue);
                    // console.log(data.product_name[i]);
                }
            });

        })
        .catch((err) => {
            console.log(err);
        })

    }

    function deBounce(func, delay){
        if(timerId){
            clearTimeout(timerId);
        }
        timerId = setTimeout(function(){
            console.log("Debounce Working");
            func();
        }, delay);
    }


</script>